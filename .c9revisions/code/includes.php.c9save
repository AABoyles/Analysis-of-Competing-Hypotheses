{"ts":1342642902790,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\n/* ////////////////////////////////////////////////////////////////////////////////\n **    Copyright 2010 Matthew Burton, http://matthewburton.org\n **    Code by Burton and Joshua Knowles, http://auscillate.com\n **\n **    This software is part of the Open Source ACH Project (ACH). You'll find\n **    all current information about project contributors, installation, updates,\n **    bugs and more at http://competinghypotheses.org.\n **\n **\n **    ACH is free software: you can redistribute it and/or modify\n **    it under the terms of the GNU General Public License as published by\n **    the Free Software Foundation, either version 3 of the License, or\n **    (at your option) any later version.\n **\n **    ACH is distributed in the hope that it will be useful,\n **    but WITHOUT ANY WARRANTY; without even the implied warranty of\n **    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n **    GNU General Public License for more details.\n **\n **    You should have received a copy of the GNU General Public License\n **    along with Open Source ACH. If not, see <http://www.gnu.org/licenses/>.\n //////////////////////////////////////////////////////////////////////////////// */\n\nini_set(\"memory_limit\", \"64M\");\n\n$LOAD_TIMER_START = microtime(TRUE);\n\nerror_reporting(E_ALL);\n\nif (strpos($_SERVER['HTTP_USER_AGENT'], \"Firefox\") > 0) {\n\t$is_firefox = TRUE;} \nelse {\n\t$is_firefox = FALSE;}\n\nif (strpos($_SERVER['HTTP_USER_AGENT'], \"MSIE\") > 0) {\n\t$is_ie = TRUE;} \nelse {\n\t$is_ie = FALSE;}\n\ninclude (\"LocalSettings.php\");\ninclude (\"common_db.php\");\ninclude (\"frameworks/framework_database.php\");\ninclude (\"class_user.php\");\ninclude (\"class_evidence.php\");\ninclude (\"class_hypothesis.php\");\ninclude (\"class_project.php\");\ninclude (\"class_comment.php\");\ninclude (\"class_credibility.php\");\ninclude (\"functions.php\");\ninclude (\"nusoap/lib/nusoap.php\");\n\nif (isset($_REQUEST['print']) && $_REQUEST['print'] == \"y\") {\n\t$print_mode = TRUE;} \nelse {\n\t$print_mode = FALSE;}\n\n$active_user = new User();\n\n//If there's cookie data, grab it!\nif (array_key_exists('cookie_user_id', $_COOKIE)) {\n\t$cookie_user_id = $_COOKIE['cookie_user_id'];\n\t$active_user -> populateFromID($cookie_user_id);}\nif (array_key_exists('cookie_user_password', $_COOKIE)) {\n\t$cookie_user_password = $_COOKIE['cookie_user_password'];\n\t$show_user_menu = TRUE;}\nelse {\n\t//TODO: Expose a variable to allow/deny anonymous users\n\t/*$new_user = new User();\n\t $new_user->username = \"anonymous\";\n\t $new_user->password = \"\";\n\t $new_user->insertNew();\n\t $new_user->setCookies();\n\t $cookie_user_id = $new_user->id;*/\n\t $show_user_menu = FALSE;\n}\n\n// Log user in users_active.\nif ($active_user -> logged_in && substr($_SERVER['REQUEST_URI'], 0, 19) != \"/insert_message.php\" && substr($_SERVER['REQUEST_URI'], 0, 22) != \"/show_active_users.php\") {\n\t$found = false;\n\t//TODO: Migrate to mysqli library\n\t$result = mysql_do(\"SELECT id FROM users_active WHERE user_id='\".$active_user->id.\"'\");\n\twhile ($query_data = mysql_fetch_array($result)) {\n\t\t$found = true;\n\t\t$this_page = $_SERVER['REQUEST_URI'];\n\t\tif ($found) {\n\t\t\tmysql_do(\"UPDATE users_active SET last_visited=NOW(), last_page='$this_page' WHERE user_id='\".$active_user->id.\"'\");} \n\t\telse {\n\t\t\tmysql_do(\"INSERT INTO users_active (id, user_id, last_visited, last_page, color) VALUES (NULL, '\".$active_user->id.\"', NOW(), '$this_page', '000000');\");}\n\t}\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":3377}]],"length":3377}
{"contributors":[],"silentsave":false,"ts":1342642970000,"patch":[[{"diffs":[[0,"nclude ("],[-1,"\""],[1,"__DIR__.\"/../"],[0,"LocalSet"]],"start1":1512,"start2":1512,"length1":17,"length2":29}]],"length":3389,"saved":false}
