{"ts":1342642902790,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\n/* ////////////////////////////////////////////////////////////////////////////////\n **    Copyright 2010 Matthew Burton, http://matthewburton.org\n **    Code by Burton and Joshua Knowles, http://auscillate.com\n **\n **    This software is part of the Open Source ACH Project (ACH). You'll find\n **    all current information about project contributors, installation, updates,\n **    bugs and more at http://competinghypotheses.org.\n **\n **\n **    ACH is free software: you can redistribute it and/or modify\n **    it under the terms of the GNU General Public License as published by\n **    the Free Software Foundation, either version 3 of the License, or\n **    (at your option) any later version.\n **\n **    ACH is distributed in the hope that it will be useful,\n **    but WITHOUT ANY WARRANTY; without even the implied warranty of\n **    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n **    GNU General Public License for more details.\n **\n **    You should have received a copy of the GNU General Public License\n **    along with Open Source ACH. If not, see <http://www.gnu.org/licenses/>.\n //////////////////////////////////////////////////////////////////////////////// */\n\nini_set(\"memory_limit\", \"64M\");\n\n$LOAD_TIMER_START = microtime(TRUE);\n\nerror_reporting(E_ALL);\n\nif (strpos($_SERVER['HTTP_USER_AGENT'], \"Firefox\") > 0) {\n\t$is_firefox = TRUE;} \nelse {\n\t$is_firefox = FALSE;}\n\nif (strpos($_SERVER['HTTP_USER_AGENT'], \"MSIE\") > 0) {\n\t$is_ie = TRUE;} \nelse {\n\t$is_ie = FALSE;}\n\ninclude (\"LocalSettings.php\");\ninclude (\"common_db.php\");\ninclude (\"frameworks/framework_database.php\");\ninclude (\"class_user.php\");\ninclude (\"class_evidence.php\");\ninclude (\"class_hypothesis.php\");\ninclude (\"class_project.php\");\ninclude (\"class_comment.php\");\ninclude (\"class_credibility.php\");\ninclude (\"functions.php\");\ninclude (\"nusoap/lib/nusoap.php\");\n\nif (isset($_REQUEST['print']) && $_REQUEST['print'] == \"y\") {\n\t$print_mode = TRUE;} \nelse {\n\t$print_mode = FALSE;}\n\n$active_user = new User();\n\n//If there's cookie data, grab it!\nif (array_key_exists('cookie_user_id', $_REQUEST)) {\n\t$cookie_user_id = $_REQUEST['cookie_user_id'];\n\t$active_user -> populateFromID($cookie_user_id);}\nif (array_key_exists('cookie_user_password', $_REQUEST)) {\n\t$cookie_user_password = $_REQUEST['cookie_user_password'];\n\t$show_user_menu = TRUE;}\nelse {\n\t//TODO: Expose a variable to allow/deny anonymous users\n\t/*$new_user = new User();\n\t $new_user->username = \"anonymous\";\n\t $new_user->password = \"\";\n\t $new_user->insertNew();\n\t $new_user->setCookies();\n\t $cookie_user_id = $new_user->id;*/\n\t $show_user_menu = FALSE;\n}\n\n// Log user in users_active.\nif ($active_user -> logged_in && substr($_SERVER['REQUEST_URI'], 0, 19) != \"/insert_message.php\" && substr($_SERVER['REQUEST_URI'], 0, 22) != \"/show_active_users.php\") {\n\t$found = false;\n\t//TODO: Migrate to mysqli library\n\t$result = mysql_do(\"SELECT id FROM users_active WHERE user_id='\".$active_user->id.\"'\");\n\twhile ($query_data = mysql_fetch_array($result)) {\n\t\t$found = true;\n\t\t$this_page = $_SERVER['REQUEST_URI'];\n\t\tif ($found) {\n\t\t\tmysql_do(\"UPDATE users_active SET last_visited=NOW(), last_page='$this_page' WHERE user_id='\".$active_user->id.\"'\");} \n\t\telse {\n\t\t\tmysql_do(\"INSERT INTO users_active (id, user_id, last_visited, last_page, color) VALUES (NULL, '\".$active_user->id.\"', NOW(), '$this_page', '000000');\");}\n\t}\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":3377}]],"length":3377}
{"contributors":[],"silentsave":false,"ts":1342642970000,"patch":[[{"diffs":[[0,"nclude ("],[-1,"\""],[1,"__DIR__.\"/../"],[0,"LocalSet"]],"start1":1512,"start2":1512,"length1":17,"length2":29}]],"length":3389,"saved":false}
{"contributors":[],"silentsave":false,"ts":1343527948372,"patch":[[{"diffs":[[0,");\n\n"],[-1,"error_reporting(E_ALL);\n\n"],[0,"if ("]],"start1":1271,"start2":1271,"length1":33,"length2":8},{"diffs":[[0,"e {\n"],[-1,"\t//TODO: Expose a variable to allow/deny anonymous users\n\t/*$new_user = new User();\n\t $new"],[1,"    if($allowAnons){\n\t    $active"],[0,"_use"]],"start1":2336,"start2":2336,"length1":98,"length2":41},{"diffs":[[0,"onymous\";\n\t "],[-1,"$new"],[1,"   $active"],[0,"_user->passw"]],"start1":2394,"start2":2394,"length1":28,"length2":34},{"diffs":[[0,"ord = \"\";\n\t "],[-1,"$new"],[1,"   $active"],[0,"_user->inser"]],"start1":2428,"start2":2428,"length1":28,"length2":34},{"diffs":[[0,"ew();\n\t "],[-1,"$new"],[1,"   $active"],[0,"_user->s"]],"start1":2464,"start2":2464,"length1":20,"length2":26},{"diffs":[[0,"es();\n\t "],[1,"   "],[0,"$cookie_"]],"start1":2497,"start2":2497,"length1":16,"length2":19},{"diffs":[[0,"r_id = $"],[-1,"new"],[1,"active"],[0,"_user->i"]],"start1":2519,"start2":2519,"length1":19,"length2":22},{"diffs":[[0,">id;"],[-1,"*/"],[0,"\n\t "],[1,"   "],[0,"$sho"]],"start1":2539,"start2":2539,"length1":13,"length2":14},{"diffs":[[0,"_menu = "],[-1,"FALSE;"],[1,"TRUE;\n    }"],[0,"\n}\n\n// L"]],"start1":2559,"start2":2559,"length1":22,"length2":27},{"diffs":[[0,"ive_user"],[-1," "],[0,"->"],[-1," "],[0,"logged_i"]],"start1":2619,"start2":2619,"length1":20,"length2":18},{"diffs":[[0,"ogged_in && "],[1,"\n    "],[0,"substr($_SER"]],"start1":2630,"start2":2630,"length1":24,"length2":29},{"diffs":[[0,"php\" && "],[1,"\n    "],[0,"substr($"]],"start1":2706,"start2":2706,"length1":16,"length2":21},{"diffs":[[0,"hp\") {\n\t"],[1,"\n    "],[0,"$found ="]],"start1":2782,"start2":2782,"length1":16,"length2":21},{"diffs":[[0,"se;\n"],[-1,"\t//TODO: Migrate to mysqli library\n"],[0,"\t$re"]],"start1":2807,"start2":2807,"length1":43,"length2":8},{"diffs":[[0,"esult = "],[-1,"mysql_do"],[1,"achquery"],[0,"(\"SELECT"]],"start1":2814,"start2":2814,"length1":24,"length2":24},{"diffs":[[0,"_URI'];\n"],[-1,"\t"],[1,"    }\n"],[0,"\tif ($fo"]],"start1":3001,"start2":3001,"length1":17,"length2":22},{"diffs":[[0,"nd) {\n\t\t"],[-1,"\tmysql_do"],[1,"achquery"],[0,"(\"UPDATE"]],"start1":3024,"start2":3024,"length1":25,"length2":24},{"diffs":[[0,"\"'\");} \n"],[-1,"\t"],[0,"\telse {\n"]],"start1":3143,"start2":3143,"length1":17,"length2":16},{"diffs":[[0,"{\n\t\t"],[-1,"\tmysql_do"],[1,"achquery"],[0,"(\"IN"]],"start1":3157,"start2":3157,"length1":17,"length2":16},{"diffs":[[0,");}\n"],[-1,"\t}\n"],[0,"}\n"]],"start1":3312,"start2":3312,"length1":9,"length2":6}]],"length":3318,"saved":false}
